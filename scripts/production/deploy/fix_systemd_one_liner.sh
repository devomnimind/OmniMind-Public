#!/bin/bash
# Comando Ãºnico para corrigir serviÃ§os systemd OmniMind
# Execute: sudo bash scripts/production/deploy/fix_systemd_one_liner.sh

sudo bash -c 'PROJECT_ROOT="/home/fahbrain/projects/omnimind"; OMNIMIND_USER="fahbrain"; SYSTEMD_DIR="/etc/systemd/system"; DAEMON_SERVICE="${SYSTEMD_DIR}/omnimind-daemon.service"; OMNIMIND_SERVICE="${SYSTEMD_DIR}/omnimind.service"; echo "ðŸ”§ Corrigindo serviÃ§os systemd..."; if [ -f "$DAEMON_SERVICE" ]; then echo "   ðŸ”„ Corrigindo omnimind-daemon.service..."; sed -i "s|__OMNIMIND_USER__|${OMNIMIND_USER}|g" "$DAEMON_SERVICE"; sed -i "s|__PROJECT_ROOT__|${PROJECT_ROOT}|g" "$DAEMON_SERVICE"; echo "   âœ… Placeholders substituÃ­dos"; fi; if [ -f "$OMNIMIND_SERVICE" ]; then echo "   ðŸ”„ Corrigindo omnimind.service..."; if ! grep -q "TimeoutStartSec" "$OMNIMIND_SERVICE"; then sed -i "/\[Service\]/a TimeoutStartSec=300s" "$OMNIMIND_SERVICE"; echo "   âœ… TimeoutStartSec=300s adicionado"; fi; if ! grep -q "TimeoutStopSec" "$OMNIMIND_SERVICE"; then sed -i "/TimeoutStartSec/a TimeoutStopSec=60s" "$OMNIMIND_SERVICE"; echo "   âœ… TimeoutStopSec=60s adicionado"; fi; fi; echo "   ðŸ”„ Recarregando daemon..."; systemctl daemon-reload; echo "   âœ… Daemon recarregado"; echo ""; echo "âœ… CorreÃ§Ã£o completa!"; echo ""; echo "ðŸ“Š Verificando status:"; systemctl status omnimind.service --no-pager -l | head -10 || true'

